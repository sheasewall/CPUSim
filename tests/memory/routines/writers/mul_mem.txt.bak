# 2 3 
1 MOVE 2 A 
2 MOVE 3 B 
3 MOVE 5 D 
4 JUMP 500 
5 MOVE 6 B 
6 MOVE 8 D 
7 JUMP 100 
8 JUMPIF 10
9 JUMP 200
10 NOOP
# -2 3
11 MOVE -2 A 
12 MOVE 3 B 
13 MOVE 15 D 
14 JUMP 500 
15 MOVE -6 B 
16 MOVE 18 D 
17 JUMP 100 
18 JUMPIF 20
19 JUMP 200
20 NOOP
# 2 -3 
21 MOVE 2 A 
22 MOVE -3 B 
23 MOVE 25 D 
24 JUMP 500 
25 MOVE -6 B 
26 MOVE 28 D 
27 JUMP 100 
28 JUMPIF 30
29 JUMP 200
30 NOOP
# -2 -3 
31 MOVE -2 A 
32 MOVE -3 B 
33 MOVE 35 D 
34 JUMP 500 
35 MOVE 6 B 
36 MOVE 38 D 
37 JUMP 100 
38 JUMPIF 40
39 JUMP 200
40 JUMP 210

# MULTIPLY A x B, STORE IN A, RETURN TO D
500 WRITE 595 0 
501 MOVE 0 C 
502 COMP B 0 
503 JUMPIF 520
504 JUMP 510

# B IS NONNEGATIVE 
510 COMP B 1
511 JUMPIF 540
512 ADD A C
513 ADD -1 B 
514 JUMP 510

# B IS NEGATIVE, NEGATE IT
520 WRITE 596 A 
521 MOVE B A
522 WRITE 599 D 
523 MOVE 525 D 
524 JUMP 300
525 READ 599 D 
526 MOVE A B 
527 READ 596 A
528 WRITE 595 1
529 JUMP 501

# FINISH MULTIPLICATION
540 MOVE C A 
541 READ 595 B 
542 CLEAR 595
543 CLEAR 596
544 CLEAR 599
545 COMP 0 B
546 JUMPIF 300
547 JUMP D 


# CHECK IF A == B, RETURNS TO D 
100 COMP A B
101 JUMPIF 106 
102 COMP B A 
103 JUMPIF 106 
104 COMP 0 1 
105 JUMP D 
106 COMP 1 0 
107 JUMP D 


# FAILURE 
200 MOVE -1 C 
201 JUMP 0 


# SUCCESS 
210 MOVE 1 C 
211 JUMP 0 


# NEGATE A, STORE IN A, RETURN TO D
# SET C TO TARGET, A TO ACCUMULATOR
300 MOVE A C 
301 MOVE 0 A
302 COMP -1 C 
303 JUMPIF 320
304 JUMP 310 

# NEG -> POS LOOP
#  INCREMENTS A UNTIL A + C > -1
310 MOVE A B 
311 ADD C B 
312 COMP -1 B 
313 JUMPIF D 
314 ADD 1 A 
315 JUMP 310

# POS -> NEG LOOP 
#  DECREMENTS A UNTIL A + C < 1
320 MOVE A B 
321 ADD C B
322 COMP B 1 
323 JUMPIF D 
324 ADD -1 A 
325 JUMP 320


# SUBTRACT A - B, STORE IN A, RETURN TO D 
400 WRITE 496 A
401 MOVE B A 
402 WRITE 499 D
403 MOVE 405 D 
404 JUMP 300 
405 READ 499 D 
406 CLEAR 499
407 READ 496 B
408 CLEAR 496
409 ADD B A
410 JUMP D 
