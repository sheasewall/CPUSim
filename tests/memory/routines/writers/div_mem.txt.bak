# 15 ÷ 5 = 3R0
#1 JUMP 61
1 MOVE 15 A 
2 MOVE 5 B
3 MOVE 5 D 
4 JUMP 600
5 WRITE 697 B 
6 MOVE 3 B
7 MOVE 9 D 
8 JUMP 100 
9 JUMPIF 11 
10 JUMP 200 
11 READ 697 A 
12 CLEAR 697 
13 MOVE 0 B 
14 MOVE 16 D 
15 JUMP 100 
16 JUMPIF 21
17 JUMP 200 
# 15 ÷ 6 = 2R3
21 MOVE 15 A 
22 MOVE 6 B
23 MOVE 25 D 
24 JUMP 600
25 WRITE 697 B 
26 MOVE 2 B
27 MOVE 29 D 
28 JUMP 100 
29 JUMPIF 31 
30 JUMP 200 
31 READ 697 A 
32 CLEAR 697
32 MOVE 3 B 
33 MOVE 36 D 
34 JUMP 100 
35 CLEAR 697
36 JUMPIF 41
37 JUMP 200 
## -3 ÷ 2 = -1 R-1
41 MOVE -3 A 
42 MOVE 2 B
43 MOVE 45 D 
44 JUMP 600
45 WRITE 697 B 
46 MOVE -1 B
47 MOVE 49 D 
48 JUMP 100 
49 JUMPIF 51 
50 JUMP 200 
51 READ 697 A
52 CLEAR 697 
53 MOVE -1 B 
54 MOVE 56 D 
55 JUMP 100 
56 JUMPIF 61
57 JUMP 200 
# 3 ÷ -2 = -1 R1
61 MOVE 3 A 
62 MOVE -2 B
63 MOVE 65 D 
64 JUMP 600
65 WRITE 697 B 
66 MOVE -1 B
67 MOVE 69 D 
68 JUMP 100 
69 JUMPIF 71 
70 JUMP 200 
71 READ 697 A 
72 CLEAR 697
73 MOVE 1 B 
74 MOVE 76 D 
75 JUMP 100 
76 JUMPIF 81
77 JUMP 200 
# -3 ÷ -2 = 1 R-1
81 MOVE -3 A 
82 MOVE -2 B
83 MOVE 85 D 
84 JUMP 600
85 WRITE 697 B 
86 MOVE 1 B
87 MOVE 89 D 
88 JUMP 100 
89 JUMPIF 91 
90 JUMP 200 
91 READ 697 A 
92 CLEAR 697
93 MOVE -1 B 
94 MOVE 96 D 
95 JUMP 100 
96 JUMPIF 210
97 JUMP 200 


# DIVIDE A ÷ B, STORE IN A, RETURN TO D
600 COMP 0 B 
601 JUMPIF 604 
602 WRITE 693 B 
603 JUMP 614
604 WRITE 696 A # SAVE REGS
605 WRITE 697 B # SAVE REGS
606 WRITE 699 D # SAVE REGS
607 MOVE B A    # NEGATE B 
608 MOVE 610 D  # NEGATE B  
609 JUMP 300    # NEGATE B   
610 WRITE 693 A # WRITE NEGATED B TO 693
611 READ 699 D  # LOAD REGS
612 READ 697 B  # LOAD REGS
613 READ 696 A  # LOAD REGS
614 MOVE 0 C    
615 COMP A 0    # IF NUMER. IS NEG 
616 JUMPIF 622  # GO TO NEGATE A SUBROUTINE
617 WRITE 694 0 # ELSE, SET 694 TO FALSE 
618 COMP B 0    # IF DENOM. IS NEG 
619 JUMPIF 632  # GO TO NEGATE B SUBROUTINE 
620 WRITE 695 0 # ELSE, SET 695 TO FALSE   
621 JUMP 700    # START DIV LOOP 

# NEGATE A, SET 694 TO 1
622 WRITE 694 1
623 WRITE 697 B 
624 WRITE 698 C 
625 WRITE 699 D 
626 MOVE 628 D 
627 JUMP 300 # NEGATE A 
628 READ 699 D 
629 READ 698 C 
630 READ 697 B 
631 JUMP 618

# NEGATE B, SET 695 TO 1
632 WRITE 695 1
633 WRITE 696 A 
634 WRITE 698 C 
635 WRITE 699 D
636 MOVE B A 
637 MOVE 639 D 
638 JUMP 300 # NEGATE A 
639 READ 699 D 
640 READ 698 C 
641 MOVE A B
642 READ 696 A
643 JUMP 621

# PERFORM FINAL NEGATION 
660 WRITE 696 A # SAVE QUOTIENT
661 WRITE 697 B # SAVE REMAINDER 
662 WRITE 699 D # SAVE RP
663 READ 694 A  # NUMERATOR IS NEG BIT
664 READ 695 B  # DENOMINATOR IS NEG BIT
665 MOVE 667 D  
666 JUMP 100    # IF NUM AND DENOM ARE BOTH POS OR BOTH NEG
667 JUMPIF 673  # THEN SKIP, ELSE NEGATE QUOTIENT
668 READ 696 A  # READ QUOTIENT INTO A 
669 MOVE 671 D  
670 JUMP 300    # NEGATE QUOTIENT
671 WRITE 696 A # SAVE NEGATED QUOTIENT
672 READ 694 A  # NUMERATOR IS NEG BIT
673 COMP A 1    # 
674 JUMPIF 679  # IF NUMERATOR IS NOT NEG
675 READ 697 A  # THEN SKIP, ELSE NEGATE REMAINDER
676 MOVE 678 D  
677 JUMP 300    # NEGATE REMAINDER (A)
678 WRITE 697 A # SAVE NEGATED REMAINDER
679 READ 696 A  # READ FINAL QUOTIENT INTO A 
680 READ 697 B  # READ FINAL REMAINDER INTO B 
681 READ 699 D
682 CLEAR 694
683 CLEAR 695
684 CLEAR 696
685 CLEAR 697 
686 CLEAR 698
687 CLEAR 699
688 CLEAR 693
689 JUMP D 

# DIVISION LOOP
700 COMP A B     # IF A < B
701 JUMPIF 720   # EXIT LOOP 
702 WRITE 697 B  # 
703 READ 693 B   #  
704 ADD B A      # A = A - B 
705 READ 697 B   #  
706 ADD 1 C      # C++
707 JUMP 700     # REPEAT

# EXIT DIV LOOP 
720 MOVE A B     # SET A TO QUOTIENT
721 MOVE C A     # SET B TO REMAINDER 
722 JUMP 660     # JUMP TO FINAL NEGATION ROUTINE



# CHECK IF A == B, RETURNS TO D 
100 COMP A B
101 JUMPIF 106 
102 COMP B A 
103 JUMPIF 106 
104 COMP 0 1 
105 JUMP D 
106 COMP 1 0 
107 JUMP D 


# FAILURE 
200 MOVE -1 C 
201 JUMP 0 


# SUCCESS 
210 MOVE 1 C 
211 JUMP 0 


# NEGATE A, STORE IN A, RETURN TO D
# SET C TO TARGET, A TO ACCUMULATOR
300 MOVE A C 
301 MOVE 0 A
302 COMP -1 C 
303 JUMPIF 320
304 JUMP 310 

# NEG -> POS LOOP
#  INCREMENTS A UNTIL A + C > -1
310 MOVE A B 
311 ADD C B 
312 COMP -1 B 
313 JUMPIF D 
314 ADD 1 A 
315 JUMP 310

# POS -> NEG LOOP 
#  DECREMENTS A UNTIL A + C < 1
320 MOVE A B 
321 ADD C B
322 COMP B 1 
323 JUMPIF D 
324 ADD -1 A 
325 JUMP 320


# SUBTRACT A - B, STORE IN A, RETURN TO D 
400 WRITE 496 A
401 MOVE B A 
402 WRITE 499 D
403 MOVE 405 D 
404 JUMP 300 
405 READ 499 D 
406 CLEAR 499
407 READ 496 B
408 CLEAR 496
409 ADD B A
410 JUMP D 


# MULTIPLY A x B, STORE IN A, RETURN TO D
500 WRITE 595 0 
501 MOVE 0 C 
502 COMP B 0 
503 JUMPIF 520
504 JUMP 510

# B IS NONNEGATIVE 
510 COMP B 1
511 JUMPIF 540
512 ADD A C
513 ADD -1 B 
514 JUMP 510

# B IS NEGATIVE, NEGATE IT
520 WRITE 596 A 
521 MOVE B A
522 WRITE 599 D 
523 MOVE 525 D 
524 JUMP 300
525 READ 599 D 
526 MOVE A B 
527 READ 596 A
528 WRITE 595 1
529 JUMP 501

# FINISH MULTIPLICATION
540 MOVE C A 
541 READ 595 B 
542 CLEAR 595
543 CLEAR 596
544 CLEAR 599
545 COMP 0 B
546 JUMPIF 300
547 JUMP D 

